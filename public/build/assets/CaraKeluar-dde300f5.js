import{r as n,aD as E,o as y,b as x,a as s,d as t,u as g,w as D,f as k,g as T,bE as m,e as w}from"./app-bf8fb3e4.js";import{s as v}from"./default-669794a9.js";import{_ as L}from"./MainButtonSmall-62f6226f.js";import{_ as U}from"./SecondaryButtonSmall-e3595e2c.js";import{_ as $}from"./TextInput-181d0a07.js";import{_ as d}from"./InputError-892d609d.js";import{_ as r}from"./InputLabel-9cc85df5.js";const q=["onSubmit"],A={class:"my-2 w-full"},B=s("h3",{class:"font-semibold text-secondhand-orange-300 mt-2"},"Cara Keluar",-1),H={class:"flex"},M={class:"w-full"},N={class:"flex"},z={class:"flex mt-3"},F={class:"w-full"},G={class:"flex"},I={class:"flex mt-3"},O={class:"w-full"},Z={class:"flex"},J={class:"flex mt-3"},Q={class:"w-full"},R={class:"flex"},W={class:"flex mt-3"},X={class:"w-full"},Y={class:"flex"},ee={class:"flex justify-between"},se={class:"mt-2 mr-3"},te={key:0,class:"text-sm text-original-teal-300"},oe={key:1,class:"text-sm text-thirdouter-red-300"},ce={__name:"CaraKeluar",props:{encounter_satusehat_id:{type:String}},setup(V){const f=V,i=n({}),S=async()=>{const{data:a}=await m.get(route("local.encounter.show",{satusehat_id:f.encounter_satusehat_id}));i.value=a},u=n(null),C=async()=>{const{data:a}=await m.get(route("kunjungan.condition",{encounter_satusehat_id:f.encounter_satusehat_id}));u.value=a.diagnosis.map(o=>({id:o.id,codeDisplay:o.code.coding[0].display}))},b=n(null),j=async()=>{const{data:a}=await m.get(route("terminologi.get"),{params:{resourceType:"EncounterHospitalization",attribute:"dischargeDisposition"}});b.value=a},K=()=>{S(),C()},e=n({diagnosismasuk:null,diagnosisprimer:null,diagnosissekunder:null,dischargeDisposition:null,dischargeDispositiontext:""}),h=n(!1),_=n(!1),c=n(!1),P=async()=>{c.value=!0;const a=new Date().toISOString().replace("Z","+00:00").replace(/\.\d{3}/,"");i.value.status="finished",i.value.period.end=a,i.value.statusHistory[i.value.statusHistory.length-1].period.end=a,i.value.location[i.value.location.length-1].period.end=a,i.value.statusHistory.push({status:"finished",period:{start:a,end:a}}),i.value.diagnosis=[],i.value.hospitalization={dischargeDisposition:{coding:[{system:e.value.dischargeDisposition.system,code:e.value.dischargeDisposition.code,display:e.value.dischargeDisposition.display}],text:e.value.dischargeDispositiontext}},e.value.diagnosismasuk!==null&&i.value.diagnosis.push({condition:{reference:"Condition/"+e.value.diagnosismasuk.id,display:e.value.diagnosismasuk.codeDisplay},use:{coding:[{system:"http://terminology.hl7.org/CodeSystem/diagnosis-role",code:"AD",display:"Admission diagnosis"}]}}),e.value.diagnosisprimer!==null&&i.value.diagnosis.push({condition:{reference:"Condition/"+e.value.diagnosisprimer.id,display:e.value.diagnosisprimer.codeDisplay},use:{coding:[{system:"http://terminology.hl7.org/CodeSystem/diagnosis-role",code:"DD",display:"Discharge diagnosis"}]},rank:1}),e.value.diagnosissekunder!==null&&i.value.diagnosis.push({condition:{reference:"Condition/"+e.value.diagnosissekunder.id,display:e.value.diagnosissekunder.codeDisplay},use:{coding:[{system:"http://terminology.hl7.org/CodeSystem/diagnosis-role",code:"DD",display:"Discharge diagnosis"}]},rank:2}),m.put(route("integration.update",{res_type:"Encounter",satusehat_id:f.encounter_satusehat_id}),i.value).then(o=>{h.value=!0,setTimeout(()=>{h.value=!1},3e3),c.value=!1}).catch(o=>{console.error("Error creating user:",o),_.value=!0,setTimeout(()=>{_.value=!1},3e3),c.value=!1})};E(()=>{j()});const p={container:"relative mx-auto w-full flex items-center justify-end box-border cursor-pointer border-2 border-neutral-grey-0 ring-0 shadow-sm rounded-xl bg-white text-sm leading-snug outline-none",search:"w-full absolute inset-0 outline-none border-0 ring-0 focus:ring-original-teal-300 focus:ring-2 appearance-none box-border text-sm font-sans bg-white rounded-xl pl-3.5 rtl:pl-0 rtl:pr-3.5",placeholder:"flex items-center h-full absolute left-0 top-0 pointer-events-none bg-transparent leading-snug pl-3.5 text-gray-500 rtl:left-auto rtl:right-0 rtl:pl-0 rtl:pr-3.5",option:"flex items-center justify-start box-border text-left cursor-pointer text-sm leading-snug py-1.5 px-3",optionPointed:"text-white bg-original-teal-300",optionSelected:"text-white bg-original-teal-300",optionDisabled:"text-gray-300 cursor-not-allowed",optionSelectedPointed:"text-white bg-original-teal-300 opacity-90",optionSelectedDisabled:"text-green-100 bg-original-teal-300 bg-opacity-50 cursor-not-allowed"};return(a,o)=>(y(),x("div",null,[s("form",{onSubmit:T(P,["prevent"])},[s("div",A,[B,s("div",H,[s("div",M,[t(r,{for:"diagnosismasuk",value:"Diagnosis Masuk"}),s("div",N,[t(g(v),{modelValue:e.value.diagnosismasuk,"onUpdate:modelValue":o[0]||(o[0]=l=>e.value.diagnosismasuk=l),mode:"single",placeholder:"Diagnosis",object:!0,options:u.value,label:"codeDisplay",valueProp:"id","track-by":"id",class:"mt-1",classes:p,required:""},null,8,["modelValue","options"])]),t(d,{class:"mt-1"})])]),s("div",z,[s("div",F,[t(r,{for:"diagnosisprimer",value:"Diagnosis Primer/Kerja"}),s("div",G,[t(g(v),{modelValue:e.value.diagnosisprimer,"onUpdate:modelValue":o[1]||(o[1]=l=>e.value.diagnosisprimer=l),mode:"single",placeholder:"Diagnosis",object:!0,options:u.value,label:"codeDisplay",valueProp:"id","track-by":"id",class:"mt-1",classes:p,required:""},null,8,["modelValue","options"])]),t(d,{class:"mt-1"})])]),s("div",I,[s("div",O,[t(r,{for:"diagnosissekunder",value:"Diagnosis Sekunder/Banding"}),s("div",Z,[t(g(v),{modelValue:e.value.diagnosissekunder,"onUpdate:modelValue":o[2]||(o[2]=l=>e.value.diagnosissekunder=l),mode:"single",placeholder:"Diagnosis",object:!0,options:u.value,label:"codeDisplay",valueProp:"id","track-by":"id",class:"mt-1",classes:p},null,8,["modelValue","options"])]),t(d,{class:"mt-1"})])]),s("div",J,[s("div",Q,[t(r,{for:"dischargeDisposition",value:"Cara Keluar"}),s("div",R,[t(g(v),{modelValue:e.value.dischargeDisposition,"onUpdate:modelValue":o[3]||(o[3]=l=>e.value.dischargeDisposition=l),mode:"single",placeholder:"Diagnosis",object:!0,options:b.value,label:"display",valueProp:"code","track-by":"code",class:"mt-1",classes:p,required:""},null,8,["modelValue","options"])]),t(d,{class:"mt-1"})])]),s("div",W,[s("div",X,[t(r,{for:"note",value:"Keterangan"}),s("div",Y,[t($,{modelValue:e.value.dischargeDispositiontext,"onUpdate:modelValue":o[4]||(o[4]=l=>e.value.dischargeDispositiontext=l),id:"note",type:"text",class:"text-sm mt-1 block w-full",placeholder:"Keterangan",required:""},null,8,["modelValue"])]),t(d,{class:"mt-1"})])])]),s("div",ee,[t(U,{type:"button",onClick:K,class:"teal-button-text"},{default:D(()=>[w("Muat data ")]),_:1}),s("div",se,[t(L,{type:"submit","is-loading":c.value,class:"teal-button text-original-white-0"},{default:D(()=>[w("Tutup Kunjungan ")]),_:1},8,["is-loading"])])]),h.value?(y(),x("p",te,"Sukses!")):k("",!0),_.value?(y(),x("p",oe,"Gagal!")):k("",!0)],40,q)]))}};export{ce as default};
